---
- name: Check if server.properties file exists
  stat:
    path: /opt/kafka/config/server.properties
  changed_when: False

- name: Modify inter.broker.protocol.version property
  lineinfile:
    path: /opt/kafka/config/server.properties
    regexp: "^inter.broker.protocol.version"
    line: "inter.broker.protocol.version={{ specification.kafka_var.version }}"

- name: Restart kafka service
  systemd:
    name: kafka
    state: started
    daemon-reload: yes
