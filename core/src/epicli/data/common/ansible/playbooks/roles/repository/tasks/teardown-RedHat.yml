---

- name: Enable system repositories and disable epirepo for offline mode
  block:
    - name: Enable system repositories
      shell: /tmp/{{ ansible_os_family }}/enable-system-repos.sh
    - name: Disable epirepo on clients
      shell: /tmp/{{ ansible_os_family }}/disable-epirepo-client-rh.sh
  when:
    - offline_mode == true

- name: Disable system repositories and setup epirepo for online mode
  block:
    - name: Enable system repositories
      shell: /tmp/{{ ansible_os_family }}/enable-system-repos.sh
    - name: Disable epirepo on clients
      shell: /tmp/{{ ansible_os_family }}/disable-epirepo-client-rh.sh
  when:
    - not groups['kubernetes_master'][0] == inventory_hostname
    - offline_mode == false
