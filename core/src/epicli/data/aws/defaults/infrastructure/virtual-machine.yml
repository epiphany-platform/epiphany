kind: infrastructure/virtual-machine
version: 0.3.0
title: "Virtual Machine Infra"
provider: aws
name: default
specification:
  name: TO_BE_SET
  count: TO_BE_SET
  subnet: TO_BE_SET
  launch_configuration: TO_BE_SET
  cluster_name: TO_BE_SET
  authorized_to_efs: False
  mount_efs: False
  tags:
    - version: 0.3.0
  size: t2.micro
  os_full_name: "ubuntu/images/hvm-ssd/ubuntu-bionic-18.04-amd64-server-20190212.1"
  os_type: linux
  availability_zones:
    - "us-east-2c" # todo change it
    - "us-east-2b"
  security:
    rules:
     - name: ssh
       description: Allow SSH
       priority: 101
       direction: Inbound
       access: Allow
       protocol: Tcp
       source_port_range: "*"
       destination_port_range: "22"
       source_address_prefix: "0.0.0.0/0"
       destination_address_prefix: "*"
     - name: out
       description: Allow out
       priority: 101
       direction: Egress
       access: Allow
       protocol: "all"
       source_port_range: "*"
       destination_port_range: "0"
       source_address_prefix: "0.0.0.0/0"
       destination_address_prefix: "*"

---
kind: infrastructure/virtual-machine
version: 0.3.0
title: "Virtual Machine Infra"
provider: aws
name: default-size-t3
specification:
  tags:
    - version: 0.3.0
  size: t3.micro
  os_type: linux
---
kind: infrastructure/virtual-machine
version: 0.3.0
title: "Virtual Machine Infra"
provider: aws
name: kubernetes-master-machine
specification:
  size: t3.small
  authorized_to_efs: False
  security:
    rules:
     - name: ssh
       description: Allow ssh traffic
       priority: 101
       direction: Inbound
       access: Allow
       protocol: Tcp
       source_port_range: "*"
       destination_port_range: "22"
       source_address_prefix: "0.0.0.0/0"
       destination_address_prefix: "*"
     - name: subnet-traffic
       description: Allow subnet traffic
       priority: 102
       direction: Inbound
       access: Allow
       protocol: ALL
       source_port_range: "*"
       destination_from_port: 0
       destination_to_port: 65536
       destination_port_range: "0"
       source_address_prefix: "10.1.1.0/24"
       destination_address_prefix: "*"
     - name: node-subnet-traffic
       description: Allow node subnet traffic
       priority: 102
       direction: Inbound
       access: Allow
       protocol: ALL
       source_port_range: "*"
       destination_from_port: 0
       destination_to_port: 65536
       destination_port_range: "0"
       source_address_prefix: "10.1.2.0/24"
       destination_address_prefix: "*"
     - name: node2-subnet-traffic
       description: Allow node subnet traffic
       priority: 102
       direction: Inbound
       access: Allow
       protocol: ALL
       source_port_range: "*"
       destination_from_port: 0
       destination_to_port: 65536
       destination_port_range: "0"
       source_address_prefix: "10.1.4.0/24"
       destination_address_prefix: "*"
     - name: out
       description: Allow out
       priority: 101
       direction: Egress
       access: Allow
       protocol: "all"
       source_port_range: "*"
       destination_port_range: "0"
       source_address_prefix: "0.0.0.0/0"
       destination_address_prefix: "0.0.0.0/0"